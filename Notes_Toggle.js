// ==UserScript==
// @name         Khamsat Notes Toggle with Auto-Save
// @namespace    http://tampermonkey.net/
// @version      2.2
// @description  عرض جزء الملاحظات مع الحفظ التلقائي وإمكانية توسيع البطاقة عند النقر عليها وإضافة إشعار حفظ عصري وعلامة في حال وجود نص محفوظ
// @author       Joe
// @match        https://khamsat.com/community/requests/*
// @match        https://khamsat.com/community/requests
// @grant        none
// ==/UserScript==

function _0x2315(){const _0x4ea806=['note-icon-container','1634103mGuMgU','querySelectorAll','addEventListener','khamsat_note_','querySelector','6252TpgIDa','left','readyState','.card-body','style','a.ajaxbtn[href^=\x22/community/requests/\x22]','none','getElementById','12ISqQiP','.note-icon','3LYUYbC','block','note-icon','absolute','includes','noteIndicator','pointer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x20bg-white\x22\x20id=\x22toggleNote\x22>الملاحظات\x20<span\x20id=\x22noteIndicator\x22\x20style=\x22color:\x20green;\x20display:\x20none;\x22>●</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22noteTextarea\x22\x20style=\x22width:\x20100%;\x20height:\x20150px;\x20resize:\x20vertical;\x22\x20placeholder=\x22اكتب\x20ملاحظاتك\x20هنا...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22saveNotification\x22\x20style=\x22display:\x20none;\x20color:\x20green;\x20font-weight:\x20bold;\x22>✔\x20تم\x20الحفظ\x20بنجاح</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','textContent','input','634560flksWD','note-tooltip','createElement','حدث\x20خطأ\x20أثناء\x20حفظ\x20الملاحظات.','آخر\x20المساهمات','4597173FVCfkq','value','forEach','error','transform','18513869hIuiRI','setItem','saveNotification','trim','12159RZeHRW','DOMContentLoaded','mouseleave','display','href','className','click','closest','4gsYZfI','position','.card','default','top','appendChild','456HYsBiz','getAttribute','cssText','div','1840SRPjwF','innerHTML','inline','pathname','location','match','.card-header','insertBefore','369054SHHYlL','noteTextarea','loading'];_0x2315=function(){return _0x4ea806;};return _0x2315();}function _0xc089(_0x38ab87,_0x219be6){const _0x2315c0=_0x2315();return _0xc089=function(_0xc08971,_0x4f8f52){_0xc08971=_0xc08971-0x1d9;let _0x573f04=_0x2315c0[_0xc08971];return _0x573f04;},_0xc089(_0x38ab87,_0x219be6);}(function(_0x37e5f7,_0x41ab62){const _0x53f7f1=_0xc089,_0x269ac6=_0x37e5f7();while(!![]){try{const _0x392262=-parseInt(_0x53f7f1(0x1eb))/0x1*(parseInt(_0x53f7f1(0x21d))/0x2)+parseInt(_0x53f7f1(0x1dc))/0x3*(-parseInt(_0x53f7f1(0x20b))/0x4)+parseInt(_0x53f7f1(0x215))/0x5*(parseInt(_0x53f7f1(0x1e1))/0x6)+-parseInt(_0x53f7f1(0x203))/0x7*(parseInt(_0x53f7f1(0x211))/0x8)+-parseInt(_0x53f7f1(0x1fa))/0x9+parseInt(_0x53f7f1(0x1f5))/0xa+-parseInt(_0x53f7f1(0x1ff))/0xb*(-parseInt(_0x53f7f1(0x1e9))/0xc);if(_0x392262===_0x41ab62)break;else _0x269ac6['push'](_0x269ac6['shift']());}catch(_0x42f1c2){_0x269ac6['push'](_0x269ac6['shift']());}}}(_0x2315,0x6700f),(function(){'use strict';const _0x5e8827=_0xc089;const _0x709870=async()=>{const _0xf5b7d4=_0xc089;try{const _0x467c35=document['querySelector']('#community_sidebar');if(_0x467c35){let _0x3d45f2=null;const _0x1e8bf9=_0x467c35[_0xf5b7d4(0x1dd)](_0xf5b7d4(0x20d));_0x1e8bf9[_0xf5b7d4(0x1fc)](_0x2befcb=>{const _0x41738a=_0xf5b7d4,_0x297dcc=_0x2befcb['querySelector'](_0x41738a(0x21b));_0x297dcc&&_0x297dcc[_0x41738a(0x1f3)][_0x41738a(0x1ef)](_0x41738a(0x1f9))&&(_0x3d45f2=_0x2befcb);});if(_0x3d45f2){const _0x33067d=document[_0xf5b7d4(0x1f7)](_0xf5b7d4(0x214));_0x33067d[_0xf5b7d4(0x208)]='card\x20u-margin-bottom--large',_0x33067d[_0xf5b7d4(0x216)]=_0xf5b7d4(0x1f2),_0x467c35[_0xf5b7d4(0x21c)](_0x33067d,_0x3d45f2);let _0x535f9c=_0xf5b7d4(0x20e);try{const _0x61ff16=window[_0xf5b7d4(0x219)][_0xf5b7d4(0x218)][_0xf5b7d4(0x21a)](/\/community\/requests\/(\d+)-/);_0x61ff16&&_0x61ff16[0x1]&&(_0x535f9c=_0x61ff16[0x1]);}catch(_0x3d5e0b){console[_0xf5b7d4(0x1fd)]('خطأ\x20أثناء\x20استخراج\x20رقم\x20الطلب:',_0x3d5e0b);}const _0xe9ce7c=_0xf5b7d4(0x1df)+_0x535f9c,_0x4772c1=localStorage['getItem'](_0xe9ce7c)||'',_0x3fba1e=document[_0xf5b7d4(0x1e8)](_0xf5b7d4(0x1d9)),_0x5da135=document[_0xf5b7d4(0x1e8)](_0xf5b7d4(0x1f0));_0x3fba1e[_0xf5b7d4(0x1fb)]=_0x4772c1;_0x4772c1[_0xf5b7d4(0x202)]()!==''&&(_0x5da135[_0xf5b7d4(0x1e5)][_0xf5b7d4(0x206)]=_0xf5b7d4(0x217));let _0x328f1e;const _0xa872c5=async()=>{const _0x42d871=_0xf5b7d4;try{localStorage[_0x42d871(0x200)](_0xe9ce7c,_0x3fba1e['value']);const _0x30775e=document[_0x42d871(0x1e8)](_0x42d871(0x201));_0x30775e['style'][_0x42d871(0x206)]=_0x42d871(0x217),setTimeout(()=>{const _0x202ccd=_0x42d871;_0x30775e[_0x202ccd(0x1e5)]['display']=_0x202ccd(0x1e7);},0x7d0),_0x5da135[_0x42d871(0x1e5)][_0x42d871(0x206)]=_0x3fba1e[_0x42d871(0x1fb)]['trim']()!==''?_0x42d871(0x217):_0x42d871(0x1e7),_0x541fdd();}catch(_0x4ba116){console[_0x42d871(0x1fd)]('خطأ\x20أثناء\x20حفظ\x20الملاحظات:',_0x4ba116),alert(_0x42d871(0x1f8));}};_0x3fba1e['addEventListener'](_0xf5b7d4(0x1f4),()=>{clearTimeout(_0x328f1e),_0x328f1e=setTimeout(_0xa872c5,0x1f4);}),document['getElementById']('toggleNote')[_0xf5b7d4(0x1de)](_0xf5b7d4(0x209),function(){const _0x3a23fd=_0xf5b7d4,_0x4c9eb0=_0x33067d[_0x3a23fd(0x1e0)](_0x3a23fd(0x1e4));_0x4c9eb0[_0x3a23fd(0x1e5)]['display']=_0x4c9eb0['style'][_0x3a23fd(0x206)]===_0x3a23fd(0x1e7)?_0x3a23fd(0x1ec):_0x3a23fd(0x1e7);});}}const _0x541fdd=()=>{const _0xc66ffe=_0xf5b7d4,_0x5cc8c0=document[_0xc66ffe(0x1dd)](_0xc66ffe(0x1e6));_0x5cc8c0[_0xc66ffe(0x1fc)](_0x470b97=>{const _0x2ae626=_0xc66ffe,_0x42d59a=_0x470b97[_0x2ae626(0x212)](_0x2ae626(0x207))[_0x2ae626(0x21a)](/\/community\/requests\/(\d+)-/);if(_0x42d59a&&_0x42d59a[0x1]){const _0x5cc6f5=_0x42d59a[0x1],_0x173fea=localStorage['getItem'](_0x2ae626(0x1df)+_0x5cc6f5);if(_0x173fea&&_0x173fea[_0x2ae626(0x202)]()!==''){if(!_0x470b97[_0x2ae626(0x20a)]('td')['querySelector'](_0x2ae626(0x1ea))){const _0x496262=document['createElement']('div');_0x496262['className']=_0x2ae626(0x1db),_0x496262[_0x2ae626(0x1e5)][_0x2ae626(0x20c)]=_0x2ae626(0x1ee),_0x496262['style'][_0x2ae626(0x1e2)]='5px',_0x496262[_0x2ae626(0x1e5)][_0x2ae626(0x20f)]='50%',_0x496262[_0x2ae626(0x1e5)][_0x2ae626(0x1fe)]='translateY(-50%)';const _0x5845f3=document[_0x2ae626(0x1f7)](_0x2ae626(0x214));_0x5845f3[_0x2ae626(0x208)]=_0x2ae626(0x1ed),_0x5845f3[_0x2ae626(0x216)]='<svg\x20style=\x22color:\x20#FFD700;\x20font-size:\x2020px;\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20width=\x2220px\x22\x20height=\x2220px\x22><path\x20d=\x22M4\x202h14a2\x202\x200\x20012\x202v14l-4-4H4a2\x202\x200\x2001-2-2V4a2\x202\x200\x20012-2z\x22/></svg>',_0x5845f3[_0x2ae626(0x1e5)]['cursor']=_0x2ae626(0x1f1);const _0x2f67b8=document[_0x2ae626(0x1f7)](_0x2ae626(0x214));_0x2f67b8['className']=_0x2ae626(0x1f6),_0x2f67b8[_0x2ae626(0x1e5)][_0x2ae626(0x213)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20min-width:\x20200px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20400px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20max-content;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20word-wrap:\x20break-word;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20pre-wrap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20line-height:\x201.5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20left:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x202px\x205px\x20rgba(0,0,0,0.2);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2f67b8[_0x2ae626(0x1f3)]=_0x173fea,_0x496262[_0x2ae626(0x1de)]('mouseenter',()=>{const _0x558e51=_0x2ae626;_0x2f67b8[_0x558e51(0x1e5)][_0x558e51(0x206)]=_0x558e51(0x1ec);}),_0x496262['addEventListener'](_0x2ae626(0x205),()=>{const _0xd54839=_0x2ae626;_0x2f67b8['style']['display']=_0xd54839(0x1e7);}),_0x496262[_0x2ae626(0x210)](_0x5845f3),_0x496262[_0x2ae626(0x210)](_0x2f67b8);const _0xda6601=_0x470b97['closest']('td');_0xda6601['style']['position']='relative',_0xda6601[_0x2ae626(0x210)](_0x496262);}}}});};_0x541fdd();}catch(_0x3dea5b){console[_0xf5b7d4(0x1fd)]('خطأ\x20في\x20سكريبت\x20تامبل\x20مونكي:',_0x3dea5b);}};document[_0x5e8827(0x1e3)]===_0x5e8827(0x1da)?document[_0x5e8827(0x1de)](_0x5e8827(0x204),_0x709870):_0x709870();}()));
