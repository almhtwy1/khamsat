// ==UserScript==
// @name         Khamsat Request Expander
// @namespace    https://khamsat.com/
// @version      1.0
// @description  توسيع تفاصيل طلبات خمسات مع إمكانية الرد السريع
// @author       Your Name
// @match        https://khamsat.com/community/requests*
// @icon         https://khamsat.com/favicon.ico
// @grant        GM_xmlhttpRequest
// ==/UserScript==

function _0x346a(_0x1092b3,_0xd8c179){const _0x436f1c=_0x436f();return _0x346a=function(_0x346a3f,_0x9e7806){_0x346a3f=_0x346a3f-0x180;let _0x5ee3e5=_0x436f1c[_0x346a3f];return _0x5ee3e5;},_0x346a(_0x1092b3,_0xd8c179);}function _0x436f(){const _0x2d4a52=['now','color:\x20green;\x20margin-top:\x2010px;','listenerAttached','text/html','currentTarget','cssText','confirm_','h3.details-head\x20a.ajaxbtn','body','children','input#confirm','POST','div','3637458dkpHyl','action','createElement','.card-body\x20article','1844466ALkwfO','\x0a.request-details-container\x20{\x20width:\x20100%;\x20box-sizing:\x20border-box;\x20padding:\x2010px;\x20background-color:\x20#fff;\x20}\x0a.request-content-wrapper\x20{\x20display:\x20flex;\x20gap:\x2020px;\x20}\x0a.request-details\x20{\x20flex:\x206;\x20text-align:\x20right;\x20}\x0a.request-comment-form\x20{\x20flex:\x204;\x20}\x0a.request-comment-form\x20textarea\x20{\x20width:\x20100%;\x20height:\x20100px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x20border:\x201px\x20solid\x20#ccc;\x20border-radius:\x204px;\x20padding:\x208px;\x20margin-bottom:\x208px;\x20}\x0a','parseFromString','4bKYdHd','innerHTML','addEventListener','nodeType','matches','appendChild','insertAdjacentElement','207270IBXzQe','toString','1079604EbRJEX','forEach','pointer','textContent','true','expanded','tr.forum_post','preventDefault','nextElementSibling','setAttribute','closest','value','button[type=\x22submit\x22],\x20input[type=\x22submit\x22]','.request-comment-form','dataset','for','style','</div>\x0a\x20\x20\x20\x20<div\x20class=\x22request-comment-form\x22></div>\x0a\x20\x20</div>\x0a</td>','40328ShqJgG','cursor','request-details-container','21JhbYQF','target','querySelector','error','1133235ymsEcx','Error\x20in\x20form\x20submission','head','length','querySelectorAll','181831MKafOP','click','toggle','href','\x22>\x0a\x20\x20<div\x20class=\x22request-content-wrapper\x22>\x0a\x20\x20\x20\x20<div\x20class=\x22request-details\x22>','form','remove'];_0x436f=function(){return _0x2d4a52;};return _0x436f();}(function(_0x49c196,_0x260381){const _0x5eedd8=_0x346a,_0x414ddc=_0x49c196();while(!![]){try{const _0x3743b0=-parseInt(_0x5eedd8(0x1a8))/0x1*(parseInt(_0x5eedd8(0x181))/0x2)+parseInt(_0x5eedd8(0x1c0))/0x3+parseInt(_0x5eedd8(0x18a))/0x4+parseInt(_0x5eedd8(0x1a3))/0x5+-parseInt(_0x5eedd8(0x188))/0x6+-parseInt(_0x5eedd8(0x19f))/0x7*(-parseInt(_0x5eedd8(0x19c))/0x8)+-parseInt(_0x5eedd8(0x1bc))/0x9;if(_0x3743b0===_0x260381)break;else _0x414ddc['push'](_0x414ddc['shift']());}catch(_0x21e0ce){_0x414ddc['push'](_0x414ddc['shift']());}}}(_0x436f,0x4f21c),(function(){'use strict';const _0x376dd4=_0x346a;const _0x5d6d49=_0x376dd4(0x1c1),_0x2199c4=document[_0x376dd4(0x1be)](_0x376dd4(0x19a));_0x2199c4[_0x376dd4(0x18d)]=_0x5d6d49,document[_0x376dd4(0x1a5)]['appendChild'](_0x2199c4);const _0x23c4e6=_0x56bd60=>new Promise((_0xb3b88f,_0x2a426b)=>{GM_xmlhttpRequest({'method':'GET','url':_0x56bd60,'onload':({responseText:_0x2b82d7})=>{const _0x53a627=_0x346a,_0xa34345=new DOMParser()[_0x53a627(0x180)](_0x2b82d7,_0x53a627(0x1b2));_0xb3b88f({'body':_0xa34345[_0x53a627(0x1a1)](_0x53a627(0x1bf)),'form':_0xa34345[_0x53a627(0x1a1)]('form#add_comment,\x20#add_comment\x20form')});},'onerror':_0x2a426b});}),_0x16588e=(_0x3206b4,_0x52d7c0)=>{const _0x269d32=_0x376dd4,_0x509863=document['createElement']('tr');_0x509863['className']=_0x269d32(0x19e),_0x509863['innerHTML']='<td\x20colspan=\x22'+_0x52d7c0+_0x269d32(0x1ac)+(_0x3206b4[_0x269d32(0x1b7)]?.[_0x269d32(0x182)]||'')+_0x269d32(0x19b);if(_0x3206b4[_0x269d32(0x1ad)]){const _0x1131ee=_0x3206b4[_0x269d32(0x1ad)]['cloneNode'](!![]);_0x1131ee['querySelectorAll']('.card-header,\x20.c-form__hb')[_0x269d32(0x18b)](_0x3741db=>_0x3741db[_0x269d32(0x1ae)]());const _0x4624f7=_0x1131ee[_0x269d32(0x1a1)](_0x269d32(0x1b9));if(_0x4624f7){const _0x4805cd=_0x269d32(0x1b5)+Date[_0x269d32(0x1af)]();_0x4624f7['id']=_0x4805cd,_0x1131ee['querySelector']('label[for=\x22confirm\x22]')?.[_0x269d32(0x193)](_0x269d32(0x199),_0x4805cd);}_0x1131ee[_0x269d32(0x1a1)](_0x269d32(0x196))?.[_0x269d32(0x183)](_0x269d32(0x1a9),async _0x54a813=>{const _0x20b18b=_0x269d32;_0x54a813[_0x20b18b(0x191)]();try{const _0x5e7c7e=new URLSearchParams(new FormData(_0x1131ee))['toString']();await new Promise((_0x1d220e,_0x4d0de5)=>{const _0xdaca03=_0x20b18b;GM_xmlhttpRequest({'method':_0xdaca03(0x1ba),'url':new URL(_0x3206b4['form'][_0xdaca03(0x1bd)],window['location'][_0xdaca03(0x1ab)])[_0xdaca03(0x189)](),'data':_0x5e7c7e,'headers':{'Content-Type':'application/x-www-form-urlencoded'},'onload':_0x1d220e,'onerror':_0x4d0de5});}),_0x1131ee[_0x20b18b(0x1a7)]('textarea')['forEach'](_0x3bbe19=>_0x3bbe19[_0x20b18b(0x195)]='');const _0x51a6af=document[_0x20b18b(0x1be)](_0x20b18b(0x1bb));_0x51a6af[_0x20b18b(0x18d)]='تم\x20إرسال\x20التعليق\x20بنجاح',_0x51a6af[_0x20b18b(0x19a)][_0x20b18b(0x1b4)]=_0x20b18b(0x1b0),_0x1131ee['appendChild'](_0x51a6af),setTimeout(()=>_0x51a6af[_0x20b18b(0x1ae)](),0xbb8);}catch(_0x52ee3d){console['error'](_0x20b18b(0x1a4),_0x52ee3d);}}),_0x509863[_0x269d32(0x1a1)](_0x269d32(0x197))[_0x269d32(0x186)](_0x1131ee);}return _0x509863;},_0x1290b0=async _0x20e7a2=>{const _0x3f2747=_0x376dd4;if(_0x20e7a2[_0x3f2747(0x1a0)][_0x3f2747(0x194)]('a,\x20button,\x20input,\x20textarea'))return;const _0x5d8458=_0x20e7a2[_0x3f2747(0x1b3)],_0x1d0184=_0x5d8458[_0x3f2747(0x1a1)](_0x3f2747(0x1b6));if(!_0x1d0184)return;if(_0x5d8458['classList'][_0x3f2747(0x1aa)](_0x3f2747(0x18f)))try{const _0x5d1652=await _0x23c4e6(_0x1d0184['href']);_0x5d8458[_0x3f2747(0x187)]('afterend',_0x16588e(_0x5d1652,_0x5d8458[_0x3f2747(0x1b8)][_0x3f2747(0x1a6)]));}catch(_0x2e5838){console[_0x3f2747(0x1a2)](_0x2e5838);}else _0x5d8458[_0x3f2747(0x192)]?.[_0x3f2747(0x1ae)]();},_0x26cdb8=_0x57e3c0=>{const _0x1d7853=_0x376dd4;!_0x57e3c0[_0x1d7853(0x198)][_0x1d7853(0x1b1)]&&(_0x57e3c0['style'][_0x1d7853(0x19d)]=_0x1d7853(0x18c),_0x57e3c0[_0x1d7853(0x183)](_0x1d7853(0x1a9),_0x1290b0),_0x57e3c0[_0x1d7853(0x198)][_0x1d7853(0x1b1)]=_0x1d7853(0x18e));},_0x260f5f=new MutationObserver(_0x53b852=>{const _0x1224e4=_0x376dd4;_0x53b852[_0x1224e4(0x18b)](({addedNodes:_0x25d5e9})=>{const _0x58a59c=_0x1224e4;_0x25d5e9[_0x58a59c(0x18b)](_0x5b681d=>{const _0x404cbc=_0x58a59c;_0x5b681d[_0x404cbc(0x184)]===Node['ELEMENT_NODE']&&(_0x5b681d[_0x404cbc(0x185)](_0x404cbc(0x190))?_0x26cdb8(_0x5b681d):_0x5b681d[_0x404cbc(0x1a7)](_0x404cbc(0x190))['forEach'](_0x26cdb8));});});});window[_0x376dd4(0x183)]('load',()=>{const _0x2fa27a=_0x376dd4;document[_0x2fa27a(0x1a7)](_0x2fa27a(0x190))[_0x2fa27a(0x18b)](_0x26cdb8),_0x260f5f['observe'](document['body'],{'childList':!![],'subtree':!![]});});}()));
